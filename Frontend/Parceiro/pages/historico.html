<!DOCTYPE html>
<html lang="pt">
  <head>
    <script src="/scripts/script.js"></script>
    <!-- Inicial configuration information -->
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Website style-->
    <link rel="stylesheet" href="/css/historico.css" />
    <link rel="shortcut icon" href="/assets/favicon.png" type="image/x-icon">
    <title>Hurb | Histórico</title>  <!--Page's title -->
  </head>
  <body onload="historico()">
    <!-- Menu and logo header -->
    <div id="header">
      <a href="/dashboard"><img id="logo" src="/assets/logo.png" alt="logo" /></a>
      <img id="menu" src="/assets/menu.png" alt="menu" />
      <h1 id="title">Histórico</h1>
    </div>
    <!-- Blue background -->
    <main id="container">
      <!-- White background -->
      <div id="wtContainer">
        <!--Previous anticipations column -->
        <div id="previousAnticipatios">
          <p class="subtitle">Antecipações Anteriores</p>
          <div id="anticipatiosColumns">
            <div class="columTitles">
              <p class="columTitle">Data</p>
              <p class="columTitle">Regra</p>
              <a href="/pages/financeiro.html" 200ms class="columTitle">Valor</a>
            </div>
            <div class="scrollContainer" id="scrollContainer">
              <!-- Text elements -->
              <div class="anticipationsColumn" id="colunaData">
              </div>
              <div class="anticipatiosColumn" id="colunaRegra">
              </div>
              <div class="anticipatiosColumn" id="colunaMontante">
              </div>
            </div>
          </div>
        </div>
        <div id="pastProjectionGraph">
          <!-- Past projections column/graph -->
          <p class="subtitle">Projeções Passadas</p>
            <div class="graphContainer">
            <div class="grafico">
              <section class="bar">
                   <canvas style="height: 350px; width: 450px;" class="bar-chart"></canvas>
         <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.1/chart.min.js"></script>
         <script>
            var api = "localhost:3000";
            //1st month value
                 url = "/month1";
                 xhttp = new XMLHttpRequest();
                 xhttp.open("GET", url, false);
                 xhttp.send();//The script's execution stops here until the server returns the requirements 
                 var retornomes1 = JSON.parse(xhttp.responseText);
                var mes1 = retornomes1['SUM(montante)']
               //2nd month value
               url = "/month2";
                 xhttp = new XMLHttpRequest();
                 xhttp.open("GET", url, false);
                 xhttp.send();//The script's execution stops here until the server returns the requirements 
                 var retornomes2 = JSON.parse(xhttp.responseText);
                var mes2 = retornomes2['SUM(montante)']
                var boy = document.getElementsByClassName('bar-chart');
                var barGraph = new Chart(boy, {
                    type: 'bar',
                    data: {
                        labels: ['Mes1', 'Mes2'],
                        datasets: [{
                            label: 'Gráfico de Antecipações em R$',
                            data: [mes1, mes2],
                            backgroundColor: [
                                'rgb(52, 104, 252, 1)',
                        ],
                        barThickness: 125,
                        borderRadius: 12
                    }]
                    },
                    options: {
                        maintainAspectRatio: false,
                        scales: {
                        x: {
                            grid: {
                            display: false
                            }
                        },
                        y: {
                            grid: {
                            display: false
                            }
                        }
                        }
                    }
                });
            </script>
    </div>
  </body>
</html>